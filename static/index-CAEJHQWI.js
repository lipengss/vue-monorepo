const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./tableInput-DkeLVOlO.js","./index-D9Dc_mid.js","./index-BEKx3aqJ.css","./IconSelect.vue_vue_type_style_index_0_lang-DCf-64ik.js","./IconSelect-BFtBUfvB.css","./index.browser-vcSNLBTf.js","./lodash-D6lYsKd-.js","./FileSaver.min-B5S8c-r5.js","./numeral-rhsuslGW.js","./tableInput-BHgmfWOg.css","./tableFunction-BYw3Ifum.js","./tableEvent-gOUibEKW.js"])))=>i.map(i=>d[i]);
import{l as R}from"./lodash-D6lYsKd-.js";import{d as O,a0 as X,a1 as G,o as d,c as _,a2 as F,F as D,l as m,z as l,A as c,M as w,S as V,f as u,m as S,u as a,J as U,C as k,a3 as J,V as L,a4 as Z,Y as H,a5 as M,a6 as N,U as Q,a7 as T,N as P,_ as B,r as z,y as C,a8 as $,j as W,w as Y,E,B as A,a as ee,Z as x,a9 as ae,aa as q,ab as le,ac as te,ad as K,ae as j,I as re,af as oe}from"./index-D9Dc_mid.js";import{F as ne}from"./FileSaver.min-B5S8c-r5.js";import"./numeral-rhsuslGW.js";function ue(t){function i(h){switch(h){case"submitForm":p();break;case"resetForm":r();break}}return[i];function p(){t.value&&t.value.validate(h=>{})}function r(){t.value&&t.value.resetFields()}}function de(){function t(i,p){i.forEach(r=>{Object.prototype.hasOwnProperty.call(r,"defaultValue")&&(typeof r.defaultValue=="object"?p[r.field]=R.cloneDeep(r.defaultValue):["string","number","boolean"].includes(typeof r.defaultValue)&&(p[r.field]=r.defaultValue)),r.children&&Array.isArray(r.children)&&t(r.children,p[r.field])})}return{setDeepVal:t}}function se(t,i,p){function r(s,n){t.value===void 0&&!Array.isArray(t.value)||t.value.forEach(v=>{if(v.relation.from[0]===n){const e=h();e[v.action]&&e[v.action](v)}})}return{onRadio:r};function h(){function s(v){p[v.relation.from[0]],console.log(v)}function n(){console.log("我被执行了：disabled")}return{isShow:s,disabled:n}}}const ie={key:0,class:"small"},pe={key:0,class:"small"},fe={key:0,class:"small"},ce={key:0,class:"small"},be={key:0,class:"small"},me={key:0,class:"small"},_e=O({__name:"formItem",props:{inputDatas:{default:Array},data:{default:{}}},setup(t){const i=t,p=X("events");function r(s,n){return s.type===n&&s.show}const{onRadio:h}=se(p,i.inputDatas,i.data);return(s,n)=>{const v=G("form-item",!0);return d(!0),_(D,null,F(i.inputDatas,e=>(d(),_(D,null,[r(e,"input")?(d(),m(a(k),{key:0,prop:e.field,rules:e.rules},{label:l(()=>[c(w(e.label)+" ",1),e.required?(d(),_("small",ie,"（必填）")):V("",!0)]),default:l(()=>[u(a(U),S({modelValue:s.data[e.field],"onUpdate:modelValue":o=>s.data[e.field]=o,"prefix-icon":e.expand.prefix,placeholder:`请输入${e.label}`},e.expand),null,16,["modelValue","onUpdate:modelValue","prefix-icon","placeholder"])]),_:2},1032,["prop","rules"])):r(e,"select")?(d(),m(a(k),{key:1,prop:e.field,rules:e.rules},{label:l(()=>[c(w(e.label)+" ",1),e.required?(d(),_("small",pe,"（必填）")):V("",!0)]),default:l(()=>[u(a(L),S({modelValue:s.data[e.field],"onUpdate:modelValue":o=>s.data[e.field]=o,placeholder:`请选择${e.label}`},e.expand),{default:l(()=>[(d(!0),_(D,null,F(e.options,o=>(d(),m(a(J),{key:o.value,value:o.value,label:o.label},null,8,["value","label"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["prop","rules"])):r(e,"radio")?(d(),m(a(k),{key:2,prop:e.field,rules:e.rules},{label:l(()=>[c(w(e.label)+" ",1),e.required?(d(),_("small",fe,"（必填）")):V("",!0)]),default:l(()=>[u(a(H),S({modelValue:s.data[e.field],"onUpdate:modelValue":o=>s.data[e.field]=o},e.expand,{onChange:o=>a(h)(o,e.field)}),{default:l(()=>[(d(!0),_(D,null,F(e.options,o=>(d(),m(a(Z),{key:o.value,label:o.value},{default:l(()=>[c(w(o.label),1)]),_:2},1032,["label"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["prop","rules"])):r(e,"checkbox")?(d(),m(a(k),{key:3,prop:e.field,rules:e.rules},{label:l(()=>[c(w(e.label)+" ",1),e.required?(d(),_("small",ce,"（必填）")):V("",!0)]),default:l(()=>[u(a(N),S({modelValue:s.data[e.field],"onUpdate:modelValue":o=>s.data[e.field]=o},e.expand),{default:l(()=>[(d(!0),_(D,null,F(e.options,o=>(d(),m(a(M),{key:o.value,label:o.value},{default:l(()=>[c(w(o.label),1)]),_:2},1032,["label"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):r(e,"switch")?(d(),m(a(k),{key:4,prop:e.field,rules:e.rules},{label:l(()=>[c(w(e.label)+" ",1),e.required?(d(),_("small",be,"（必填）")):V("",!0)]),default:l(()=>[u(a(Q),S({modelValue:s.data[e.field],"onUpdate:modelValue":o=>s.data[e.field]=o},e.expand),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])):r(e,"datePicker")?(d(),m(a(k),{key:5,prop:e.field,rules:e.rules},{label:l(()=>[c(w(e.label)+" ",1),e.required?(d(),_("small",me,"（必填）")):V("",!0)]),default:l(()=>[u(a(T),S({modelValue:s.data[e.field],"onUpdate:modelValue":o=>s.data[e.field]=o,type:"date",placeholder:`请选择${e.label}`},e.expand),null,16,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["prop","rules"])):r(e,"object")?(d(),m(a(P),{key:6,header:e.label,class:"mb18"},{default:l(()=>[u(v,{"input-datas":e.children,data:i.data[e.field]},null,8,["input-datas","data"])]),_:2},1032,["header"])):V("",!0)],64))),256)}}}),he=B(_e,[["__scopeId","data-v-734789c4"]]),ve=O({__name:"renderForm",props:{formState:{default:Object}},setup(t){const i=t,p=z(),r=C({data:{}});$("events",W(()=>i.formState.events));const[h]=ue(p),{setDeepVal:s}=de();return Y(()=>i.formState.inputDatas,n=>{s(n,r.data)},{deep:!0,immediate:!0}),(n,v)=>{var e;return d(),m(a(A),S({ref_key:"formRef",ref:p,"hide-required-asterisk":"","status-icon":"",model:r.data},(e=n.formState)==null?void 0:e.attrs),{default:l(()=>[u(he,{"input-datas":i.formState.inputDatas,data:r.data},null,8,["input-datas","data"]),i.formState.functions?(d(),m(a(k),{key:0},{default:l(()=>[(d(!0),_(D,null,F(i.formState.functions,(o,g)=>(d(),m(a(E),{key:g,type:o.type,icon:o.icon,onClick:I=>a(h)(o.fun_type)},{default:l(()=>[c(w(o.name),1)]),_:2},1032,["type","icon","onClick"]))),128))]),_:1})):V("",!0)]),_:1},16,["model"])}}});var f=(t=>(t.input="input",t.numberInput="numberInput",t.select="select",t.radio="radio",t.checkbox="checkbox",t.switch="switch",t.datePicker="datePicker",t.dateTimePicker="dateTimePicker",t.object="object",t))(f||{}),ye=(t=>(t.year="year",t.month="month",t.week="week",t.dates="dates",t.daterange="daterange",t))(ye||{});const we={class:"dialog-footer"},Ve=O({__name:"popupCreateForm",emits:["handleConfirm"],setup(t,{emit:i}){const p=K(()=>j(()=>import("./tableInput-DkeLVOlO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)),r=K(()=>j(()=>import("./tableFunction-BYw3Ifum.js"),__vite__mapDeps([10,3,1,2,4,5]),import.meta.url)),h=K(()=>j(()=>import("./tableEvent-gOUibEKW.js"),__vite__mapDeps([11,5,1,2]),import.meta.url)),s=z(),n=C({visible:!1,title:"表单编辑",tabActive:"input",formState:{attrs:{labelPosition:"top"},inputDatas:[{label:"实时推送",field:"real_time_push",type:f.switch,id:"j8PJZMna7_50vQh6k4W9P",parent:"j8PJZMna7_50vQh6k4W9P",show:!0,expand:{clearable:!0},required:!1,defaultValue:""},{label:"起始时间",field:"now_time",type:f.radio,id:"TGDwgBgX-sPBDRmULKTu7",parent:"TGDwgBgX-sPBDRmULKTu7",show:!0,expand:{clearable:!0},required:!1,defaultValue:"now_time",options:[{label:"当前时间",value:"now_time"},{label:"自定义时间",value:"custom_time"}]},{label:"自定义面板",field:"time_panel",type:f.object,id:"AIc-M2Hf9d0iTMid6pKPr",parent:"AIc-M2Hf9d0iTMid6pKPr",show:!1,expand:{clearable:!0},required:!1,defaultValue:{},children:[{label:"自定义时间",field:"custom_time",type:f.input,id:"v56ByIXR-F6bkIxc9wtRp",parent:"AIc-M2Hf9d0iTMid6pKPr|v56ByIXR-F6bkIxc9wtRp",show:!0,expand:{clearable:!0},required:!1},{label:"方法名称",field:"method_name",type:f.input,id:"CQKjmzrHyvGdjhSuk9HOZ",parent:"AIc-M2Hf9d0iTMid6pKPr|CQKjmzrHyvGdjhSuk9HOZ",show:!0,expand:{clearable:!0},required:!1}]},{label:"数据来源",field:"source_type",type:f.radio,id:"SK9hmOFKwEUDciGzYH6cr",parent:"SK9hmOFKwEUDciGzYH6cr",show:!0,expand:{clearable:!0},required:!1,defaultValue:"model_info",options:[{label:"模型信息",value:"model_info"},{label:"数据表信息",value:"database_info"}]},{label:"模型信息",field:"model_info",type:f.object,id:"Lz_E9EPujmupbRXolI_bV",parent:"SK9hmOFKwEUDciGzYH6cr|Lz_E9EPujmupbRXolI_bV",show:!0,expand:{clearable:!0},required:!1,defaultValue:{},children:[{label:"模型",field:"name",type:f.input,id:"EvAWBqjoNANDXQOGnNDQ8",parent:"SK9hmOFKwEUDciGzYH6cr|Lz_E9EPujmupbRXolI_bV|EvAWBqjoNANDXQOGnNDQ8",show:!0,expand:{clearable:!0},required:!1},{label:"版本",field:"version",type:f.input,id:"2hFgMZzTxA9HV_QsBxvBz",parent:"SK9hmOFKwEUDciGzYH6cr|Lz_E9EPujmupbRXolI_bV|2hFgMZzTxA9HV_QsBxvBz",show:!0,expand:{clearable:!0},required:!1},{label:"属性块",field:"block",type:f.input,id:"ZXwbPIsMD7krBOPXDEvRe",parent:"SK9hmOFKwEUDciGzYH6cr|Lz_E9EPujmupbRXolI_bV|ZXwbPIsMD7krBOPXDEvRe",show:!0,expand:{clearable:!0},required:!1},{label:"字段",field:"field",type:f.input,id:"-rv6mFIrNwdRyz_67HFgH",parent:"SK9hmOFKwEUDciGzYH6cr|Lz_E9EPujmupbRXolI_bV|-rv6mFIrNwdRyz_67HFgH",show:!0,expand:{clearable:!0},required:!1}]},{label:"数据表信息",field:"database_info",type:f.object,id:"9cJTZq23XJuIIOA06gs9_",parent:"SK9hmOFKwEUDciGzYH6cr|9cJTZq23XJuIIOA06gs9_",show:!1,expand:{clearable:!0},required:!1,defaultValue:{},children:[{label:"数据库",field:"database",type:f.input,id:"qo6-X_wuNqTOae_2SNzot",parent:"SK9hmOFKwEUDciGzYH6cr|9cJTZq23XJuIIOA06gs9_|qo6-X_wuNqTOae_2SNzot",show:!0,expand:{clearable:!0},required:!1},{label:"表名",field:"table",type:f.input,id:"KlgEMYpBMT8ZrWOaL5lqH",parent:"SK9hmOFKwEUDciGzYH6cr|9cJTZq23XJuIIOA06gs9_|KlgEMYpBMT8ZrWOaL5lqH",show:!0,expand:{clearable:!0},required:!1},{label:"字段名",field:"field",type:f.input,id:"cQsdlws1FxISr4tiPeO9-",parent:"SK9hmOFKwEUDciGzYH6cr|9cJTZq23XJuIIOA06gs9_|cQsdlws1FxISr4tiPeO9-",show:!0,expand:{clearable:!0},required:!1}]}],functions:[{name:"表单提交",type:"success",icon:"Plus",fun_type:"submitForm",id:"vR6oBGfpmy6hiIIFHgWSu"},{name:"表单重置",type:"default",icon:"Refresh",fun_type:"resetForm",id:"bqb4KZdh_rnCcLVrLX0eh"}],events:[{name:"数据来源",relation:{from:["source_type"],to:[["model_info","name"],["model_info","version"],["model_info","block"],["model_info","field"],["database_info","database"],["database_info","table"],["database_info","field"]]},action:"isShow",id:"DbXlkECIFfJj-aPckO7rK"}]}}),v=i;function e(){n.title="表单编辑",n.visible=!0}function o(){const I=JSON.stringify(n.formState,void 0,4);var b=new Blob([I],{type:"json/plain;charset=utf-8"});ne.saveAs(b,`表单数据${Date.now()}.json`)}function g(I){I&&(console.log(JSON.stringify(n.formState)),I.validate((b,y)=>{b?(v("handleConfirm",n.formState),n.visible=!1):y&&re.error(Object.values(y)[0][0].message)}))}return(I,b)=>(d(),_(D,null,[u(a(le),{modelValue:n.visible,"onUpdate:modelValue":b[4]||(b[4]=y=>n.visible=y),size:"80%",title:n.title},{footer:l(()=>[ee("span",we,[u(a(E),{onClick:b[2]||(b[2]=y=>n.visible=!1)},{default:l(()=>[c("取消")]),_:1}),u(a(E),{type:"primary",onClick:b[3]||(b[3]=y=>g(s.value))},{default:l(()=>[c(" 保存 ")]),_:1})])]),default:l(()=>[u(a(A),{ref_key:"formRef",ref:s,model:n.formState,"show-message":!1},{default:l(()=>[u(a(k),{label:"表单布局"},{default:l(()=>[u(a(H),{modelValue:n.formState.attrs.labelPosition,"onUpdate:modelValue":b[0]||(b[0]=y=>n.formState.attrs.labelPosition=y)},{default:l(()=>[u(a(x),{label:"left"},{default:l(()=>[c("left")]),_:1}),u(a(x),{label:"right"},{default:l(()=>[c("right")]),_:1}),u(a(x),{label:"top"},{default:l(()=>[c("top")]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(a(ae),{modelValue:n.tabActive,"onUpdate:modelValue":b[1]||(b[1]=y=>n.tabActive=y)},{default:l(()=>[u(a(q),{name:"input",label:"表单"},{default:l(()=>[u(a(p),{datas:n.formState.inputDatas},null,8,["datas"])]),_:1}),u(a(q),{name:"function",label:"功能"},{default:l(()=>[u(a(r),{datas:n.formState.functions},null,8,["datas"])]),_:1}),u(a(q),{name:"event",label:"事件"},{default:l(()=>[u(a(h),{inputs:n.formState.inputDatas,datas:n.formState.events},null,8,["inputs","datas"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),u(a(te),{class:"mb18"},{default:l(()=>[u(a(E),{icon:"Edit",type:"primary",onClick:e},{default:l(()=>[c("编辑表单")]),_:1}),u(a(E),{icon:"Download",type:"danger",onClick:o},{default:l(()=>[c("下载表单JSON")]),_:1})]),_:1})],64))}}),ke=B(Ve,[["__scopeId","data-v-92ab1d4d"]]),Se=O({__name:"index",setup(t){const i=z({attrs:{"label-position":"top"},inputDatas:[],functions:[],events:[]});function p(r){i.value=oe(r)}return(r,h)=>(d(),m(a(P),{title:"表单组件"},{default:l(()=>[u(ke,{onHandleConfirm:p}),u(ve,{formState:i.value},null,8,["formState"])]),_:1}))}}),Oe=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{ye as D,f as E,Oe as i};
